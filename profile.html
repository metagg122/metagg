<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    

  </head>
    
  <body>
  <!DOCTYPE html><html lang="ar"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>META EGG</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#8B4513 0%,#D2691E 50%,#CD853F 100%);color:#fff;min-height:100vh;user-select:none;overflow-x:hidden;opacity:0;animation:fadeIn .5s ease forwards}@keyframes fadeIn{to{opacity:1}}@keyframes slideDown{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.top-bar{position:fixed;top:0;left:0;right:0;height:50px;background:linear-gradient(90deg,#2c1810,#654321);display:flex;align-items:center;justify-content:center;padding:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,.4);animation:slideDown .4s ease}.top-icon{width:35px;height:35px}.rank-badge{position:fixed;top:50px;left:10px;z-index:999;animation:slideDown .6s ease}.rank-badge img{width:80px;height:auto;display:block}.main-container{padding-top:50px;max-width:100%;margin:0}.profile-card{background:linear-gradient(135deg,#654321 0%,#8B4513 100%);padding:15px;box-shadow:0 10px 40px rgba(0,0,0,.5);margin:0;animation:slideDown .7s ease}.profile-header{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:15px;padding-bottom:15px;border-bottom:2px solid rgba(139,79,191,.3)}.avatar-container{position:relative;width:90px;height:90px;flex-shrink:0}.avatar-frame{position:absolute;top:-8px;left:-8px;width:106px;height:106px;z-index:2;pointer-events:none}.avatar-frame img{width:100%;height:100%;object-fit:contain}.avatar{width:75px;height:75px;border-radius:50%;background:linear-gradient(135deg,#f0c30f,#ffd700);display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;box-shadow:0 5px 15px rgba(240,195,15,.4);overflow:hidden;position:absolute;top:8px;left:8px;z-index:1}.avatar img{width:100%;height:100%;object-fit:cover}.edit-avatar-icon{position:absolute;bottom:3px;right:3px;width:26px;height:26px;background:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 3px 10px rgba(0,0,0,.4);transition:all .3s;z-index:3}.edit-avatar-icon:hover{transform:scale(1.1)}.edit-avatar-icon i{color:#333;font-size:12px}.verify-badge{width:20px;height:20px;margin-left:5px;vertical-align:middle}.profile-info{text-align:center;width:100%}.profile-name{font-size:18px;font-weight:700;margin-bottom:3px;display:flex;align-items:center;justify-content:center;gap:5px}.profile-email{font-size:12px;color:rgba(255,255,255,.7);margin-bottom:5px;display:flex;align-items:center;justify-content:center;gap:5px}.email-text{transition:all .3s}.email-hidden{letter-spacing:2px}.email-toggle-icon{cursor:pointer;font-size:11px;opacity:.7;transition:all .3s}.email-toggle-icon:hover{opacity:1;transform:scale(1.1)}.tab-container{display:flex;gap:5px;margin-bottom:0}.tab-btn{padding:8px 12px;background:transparent;border:none;color:rgba(255,255,255,.8);font-weight:600;font-size:11px;cursor:pointer;transition:all .3s;text-align:center;border-radius:6px 6px 0 0;position:relative;flex:1}.tab-btn:hover{background:rgba(139,69,19,.3);color:#fff}.tab-btn.active{background:rgba(139,69,19,.5);color:#fff}.tab-btn.active::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:#ffd700}.section-content{display:none;padding-top:15px}.section-content.active{display:block}.form-group{margin-bottom:12px}.form-label{display:block;font-size:11px;font-weight:700;color:#ffd700;margin-bottom:6px}.form-input,.form-select{width:100%;padding:10px;background:rgba(139,69,19,.6);border:2px solid rgba(139,79,191,.4);border-radius:8px;color:#fff;font-size:12px;transition:all .3s}.form-input:focus,.form-select:focus{outline:none;border-color:#ffd700;box-shadow:0 0 10px rgba(255,215,0,.3)}.form-input::placeholder{color:rgba(255,255,255,.5)}.form-input:disabled{background:rgba(139,69,19,.4);cursor:not-allowed}.save-btn{width:100%;padding:12px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#4a2d7c;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s;box-shadow:0 4px 15px rgba(255,215,0,.4);margin-top:8px}.save-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(255,215,0,.6)}.red-warning{background:rgba(255,0,0,.15);border:2px solid #ff0000;border-radius:8px;padding:12px;margin-top:12px;text-align:center;color:#ff4444;font-size:12px;font-weight:700;line-height:1.5;animation:pulse 2s infinite;transition:all .3s}.red-warning.hidden{display:none}.verification-status{background:rgba(255,68,68,.8);color:#fff;padding:12px;border-radius:8px;text-align:center;font-size:13px;font-weight:700;margin-top:15px;border:2px solid #ff0000}.verification-status.success{background:rgba(76,175,80,.8);border-color:#4caf50}.verify-notice{background:rgba(255,68,68,.2);border:2px solid #ff4444;color:#ffcccc;padding:10px;border-radius:8px;text-align:center;font-size:11px;font-weight:700;margin-top:15px;cursor:pointer;transition:all .3s}.verify-notice:hover{background:rgba(255,68,68,.3)}.security-header{background:linear-gradient(135deg,rgba(139,69,19,.8),rgba(139,69,19,.6));border-radius:10px;padding:15px;margin-bottom:15px;border:2px solid rgba(139,79,191,.3);text-align:center}.security-icon{width:60px;height:60px;margin:0 auto 10px;display:block}.security-title{font-size:16px;font-weight:700;color:#ffd700;margin-bottom:8px}.security-desc{font-size:11px;color:rgba(255,255,255,.8);line-height:1.5;margin-bottom:12px}.activate-btn{background:linear-gradient(135deg,#4caf50,#8bc34a);border:none;color:#fff;padding:10px 20px;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;transition:all .3s;box-shadow:0 4px 15px rgba(76,175,80,.4)}.activate-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(76,175,80,.6)}.activate-btn.activated{background:linear-gradient(135deg,#888,#666);cursor:not-allowed}.security-options{background:rgba(139,69,19,.6);border-radius:10px;padding:15px;border:2px solid rgba(139,79,191,.3);display:none;margin-top:15px}.security-options.show{display:block}.security-option{background:rgba(139,69,19,.5);border-radius:8px;padding:12px;margin-bottom:10px;display:flex;align-items:center;justify-content:space-between;border:2px solid rgba(139,79,191,.2)}.security-option-text{font-size:12px;color:#fff;font-weight:600}.toggle-switch{position:relative;width:50px;height:26px;background:rgba(255,0,0,.5);border-radius:13px;cursor:pointer;transition:all .3s}.toggle-switch.active{background:rgba(76,175,80,.7)}.toggle-switch::after{content:'';position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:all .3s;box-shadow:0 2px 5px rgba(0,0,0,.3)}.toggle-switch.active::after{left:27px}.wallet-section{background:rgba(139,69,19,.6);border-radius:10px;padding:15px;border:2px solid rgba(139,79,191,.3);margin-top:15px}.wallet-desc{font-size:11px;color:rgba(255,255,255,.8);margin-bottom:12px;line-height:1.5;text-align:center}.wallet-warning{background:rgba(255,68,68,.2);border:2px solid #ff4444;border-radius:6px;padding:10px;margin-bottom:12px;font-size:10px;color:#ffcccc;text-align:center}.wallet-item{background:rgba(139,69,19,.6);border-radius:8px;padding:10px;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;border:2px solid rgba(76,175,80,.5)}.wallet-item-info{flex:1;min-width:0}.wallet-item-address{font-size:11px;color:#fff;margin-bottom:4px;word-break:break-all}.wallet-verified{font-size:10px;color:#4caf50;font-weight:700}.wallet-item-delete{background:rgba(255,0,0,.7);border:none;color:#fff;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:10px;flex-shrink:0}.add-wallet-btn{width:100%;background:rgba(255,215,0,.2);border:2px solid #ffd700;color:#ffd700;padding:10px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:700;transition:all .3s;margin-top:8px}.add-wallet-btn:hover{background:rgba(255,215,0,.3);transform:scale(1.02)}.privilege-item{background:linear-gradient(135deg,rgba(139,69,19,.8),rgba(139,69,19,.6));border-radius:12px;padding:15px;margin-bottom:12px;border:2px solid rgba(139,79,191,.3);display:flex;align-items:center;gap:12px;box-shadow:0 4px 15px rgba(0,0,0,.3);transition:all .3s}.privilege-item:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.4)}.privilege-icon-container{position:relative;width:65px;height:65px;flex-shrink:0}.privilege-frame{position:absolute;top:-8px;left:-8px;width:81px;height:81px;z-index:2;pointer-events:none}.privilege-frame img{width:100%;height:100%;object-fit:contain}.privilege-icon{width:50px;height:50px;border-radius:10px;overflow:hidden;box-shadow:0 3px 10px rgba(0,0,0,.3);position:absolute;top:8px;left:8px;z-index:1}.privilege-icon img{width:100%;height:100%;object-fit:cover}.privilege-info{flex:1;min-width:0}.privilege-title{font-size:15px;font-weight:700;color:#ffd700;margin-bottom:6px}.privilege-desc{font-size:11px;color:rgba(255,255,255,.8);margin-bottom:8px;line-height:1.3}.progress-container{position:relative;width:100%;height:16px;background:rgba(0,0,0,.3);border-radius:8px;overflow:hidden;box-shadow:inset 0 2px 5px rgba(0,0,0,.3)}.progress-bar{height:100%;background:linear-gradient(90deg,#4caf50,#8bc34a);border-radius:8px;transition:width .6s ease;box-shadow:0 0 10px rgba(76,175,80,.5)}.progress-dot{width:16px;height:16px;background:#4caf50;border-radius:50%;box-shadow:0 0 10px rgba(76,175,80,.8)}.claim-btn{background:rgba(255,192,203,.3);border:2px solid rgba(255,192,203,.5);color:#fff;padding:6px 12px;border-radius:6px;font-size:10px;font-weight:700;white-space:nowrap;flex-shrink:0;cursor:pointer;transition:all .3s}.claim-btn.owned{background:rgba(255,192,203,.8);color:#8B4513}.claim-btn.disabled{background:rgba(100,100,100,.3);border-color:rgba(100,100,100,.5);color:rgba(255,255,255,.5);cursor:not-allowed}.claim-btn.use-btn{background:linear-gradient(135deg,#ffd700,#ffed4e);color:#4a2d7c;border:2px solid #ffd700}.claim-btn.use-btn:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(255,215,0,.6)}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:9999;display:none;align-items:center;justify-content:center;animation:fadeIn .3s ease}.modal-overlay.show{display:flex}.modal-content{background:linear-gradient(135deg,#654321,#8B4513);padding:25px;border-radius:15px;box-shadow:0 10px 50px rgba(0,0,0,.5);max-width:400px;width:90%;animation:slideDown .4s ease}.modal-title{font-size:18px;font-weight:700;color:#ffd700;margin-bottom:20px;text-align:center}.modal-options{display:flex;flex-direction:column;gap:10px;margin-bottom:15px}.modal-option-btn{width:100%;padding:12px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#4a2d7c;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s}.modal-option-btn:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(255,215,0,.6)}.modal-input{width:100%;padding:12px;background:rgba(139,69,19,.6);border:2px solid rgba(139,79,191,.4);border-radius:8px;color:#fff;font-size:14px;margin-bottom:15px;text-align:center;display:none}.modal-input:focus{outline:none;border-color:#ffd700;box-shadow:0 0 10px rgba(255,215,0,.3)}.file-upload-area{width:100%;padding:30px;background:rgba(139,69,19,.6);border:2px dashed rgba(139,79,191,.4);border-radius:8px;text-align:center;cursor:pointer;transition:all .3s;display:none;margin-bottom:15px}.file-upload-area:hover{border-color:#ffd700;background:rgba(139,69,19,.8)}.file-upload-area i{font-size:40px;color:#ffd700;margin-bottom:10px;display:block}.file-upload-text{font-size:12px;color:rgba(255,255,255,.7)}.file-preview{width:100%;max-height:200px;border-radius:8px;margin-bottom:15px;display:none}.modal-buttons{display:flex;gap:10px}.modal-btn{flex:1;padding:12px;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s}.modal-btn-save{background:linear-gradient(135deg,#ffd700,#ffed4e);color:#4a2d7c}.modal-btn-save:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(255,215,0,.6)}.modal-btn-cancel{background:rgba(255,0,0,.7);color:#fff}.modal-btn-cancel:hover{background:rgba(255,0,0,.9)}.success-toast{position:fixed;top:60px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#4caf50,#8bc34a);color:#fff;padding:15px 30px;border-radius:10px;font-size:14px;font-weight:700;z-index:10000;box-shadow:0 5px 20px rgba(76,175,80,.5);display:none;animation:slideDown .4s ease}.success-toast.show{display:block}</style></head><body><div class="top-bar"><img src="https://cdn-icons-png.flaticon.com/128/5969/5969105.png" class="top-icon" alt="icon"></div><div class="rank-badge" id="rankBadge"><img id="rankBadgeImg" src="https://files.catbox.moe/lwz8oi.png" alt="rank"></div><div class="main-container"><div class="profile-card"><div class="profile-header"><div class="avatar-container"><div class="avatar-frame"><img src="https://files.catbox.moe/nl89ql.png" alt="frame"></div><div class="avatar" id="userAvatar">X</div><div class="edit-avatar-icon" onclick="toggleEditOptions()"><i class="fas fa-pen"></i></div></div><div class="profile-info"><div class="profile-name"><img src="https://cdn-icons-png.flaticon.com/128/10629/10629607.png" class="verify-badge" alt="verified" id="verifyBadge" style="display:none"><span id="displayName">Loading...</span></div><div class="profile-email"><span class="email-text" id="displayEmail">user@example.com</span><i class="fas fa-eye email-toggle-icon" id="emailToggle" onclick="toggleEmailVisibility()"></i></div></div></div><div class="tab-container"><button class="tab-btn active" onclick="switchTab('account')">Account Status</button><button class="tab-btn" onclick="switchTab('security')">Security Settings</button><button class="tab-btn" onclick="switchTab('privileges')">My Privileges</button></div><div class="section-content active" id="accountSection"><div class="form-group"><label class="form-label">First Name</label><input type="text" class="form-input" id="firstName" placeholder="Enter your first name"></div><div class="form-group"><label class="form-label">Last Name</label><input type="text" class="form-input" id="lastName" placeholder="Enter your last name"></div><div class="form-group"><label class="form-label">Birth Date</label><input type="date" class="form-input" id="birthDate"></div><div class="form-group"><label class="form-label">Address</label><input type="text" class="form-input" id="address" placeholder="Enter your address"></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="email" disabled></div><div class="form-group"><label class="form-label">Country</label><select class="form-select" id="country"><option value="">Select Country</option><option value="EG">Egypt</option><option value="SA">Saudi Arabia</option><option value="AE">UAE</option><option value="KW">Kuwait</option><option value="QA">Qatar</option><option value="BH">Bahrain</option><option value="OM">Oman</option><option value="JO">Jordan</option><option value="LB">Lebanon</option><option value="SY">Syria</option><option value="IQ">Iraq</option><option value="YE">Yemen</option><option value="PS">Palestine</option><option value="LY">Libya</option><option value="SD">Sudan</option><option value="TN">Tunisia</option><option value="DZ">Algeria</option><option value="MA">Morocco</option><option value="MR">Mauritania</option></select></div><div id="idUploadSection"><div class="form-group"><label class="form-label">ID Front Image URL</label><input type="text" class="form-input" id="idFront" placeholder="Enter ID front image URL"></div><div class="form-group"><label class="form-label">ID Back Image URL</label><input type="text" class="form-input" id="idBack" placeholder="Enter ID back image URL"></div></div><button class="save-btn" onclick="saveInfo()">Save Information</button><div class="red-warning" id="warningBox">⚠️ Warning: Make sure all entered data is correct. Cannot be modified after final confirmation!</div><div id="verificationStatus"></div><div id="verifyNoticeSection"></div></div><div class="section-content" id="securitySection"><div class="security-header"><img src="https://cdn-icons-png.flaticon.com/128/7902/7902043.png" class="security-icon" alt="security"><div class="security-title">Account Security Protection</div><div class="security-desc">Enable two-factor authentication to protect your account from unauthorized access and secure withdrawal operations</div><button class="activate-btn" id="activateSecurityBtn" onclick="activateSecurity()">Activate Security</button></div><div class="security-options" id="securityOptions"><div class="security-option"><span class="security-option-text">Enable Login Security</span><div class="toggle-switch" id="loginToggle" onclick="toggleSecurity('login')"></div></div><div class="security-option"><span class="security-option-text">Enable Withdrawal Security</span><div class="toggle-switch" id="withdrawToggle" onclick="toggleSecurity('withdraw')"></div></div></div><div class="wallet-section"><div class="wallet-desc">Please verify the address. You can withdraw your cash prizes through this address only. Maximum 3 addresses can be added. Verify addresses before adding.</div><div class="wallet-warning">⚠️ Warning: Verify TRC20 address correctness. Cannot be changed after confirmation.</div><div id="walletList"></div><button class="add-wallet-btn" onclick="addWallet()"><i class="fas fa-plus"></i> Add TRC20 Address</button></div></div><div class="section-content" id="privilegesSection"><div id="privilegesList"></div></div></div></div><div class="modal-overlay" id="editModal"><div class="modal-content"><div class="modal-title" id="modalTitle">Edit Profile</div><div class="modal-options" id="modalOptions"><button class="modal-option-btn" onclick="selectEditType('username')">Change Username</button><button class="modal-option-btn" onclick="selectEditType('avatar')">Change Avatar</button></div><input type="text" class="modal-input" id="modalInput" placeholder=""><div class="file-upload-area" id="fileUploadArea" onclick="document.getElementById('fileInput').click()"><i class="fas fa-cloud-upload-alt"></i><div class="file-upload-text">Click to upload image or paste URL</div><input type="file" id="fileInput" accept="image/*" style="display:none" onchange="handleFileSelect(event)"></div><img class="file-preview" id="filePreview"><div class="modal-buttons" id="modalButtons"><button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button></div></div></div><div class="success-toast" id="successToast">✓ Saved Successfully!</div><script type="module">import{initializeApp}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";import{getAuth,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";import{getFirestore,doc,getDoc,setDoc,updateDoc}from"https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";const firebaseConfig={apiKey:"AIzaSyA-MK1RYmvpYJrTOBAQcxDqxhp-z_FOb1o",authDomain:"mzjsjjshs.firebaseapp.com",projectId:"mzjsjjshs",storageBucket:"mzjsjjshs.firebasestorage.app",messagingSenderId:"944370558426",appId:"1:944370558426:web:70d4ee772c487f48b58ce3",measurementId:"G-CWJWKWBBST"},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app);let currentUser=null,editType="",selectedFile=null,emailVisible=!0;const PRIVILEGE_LEVELS=[{level:1,title:"Level 1",icon:"https://files.catbox.moe/nl89ql.png",requiredAmount:0,desc:"Congratulations! You have this level"},{level:2,title:"Level 2",icon:"https://files.catbox.moe/5xorx9.png",requiredAmount:200,desc:"Requires $200 spent to unlock"},{level:3,title:"Level 3",icon:"https://files.catbox.moe/1twgvt.png",requiredAmount:500,desc:"Requires $500 spent to unlock"},{level:4,title:"Level 4",icon:"https://files.catbox.moe/x1goqu.png",requiredAmount:1e3,desc:"Requires $1000 spent to unlock"}];function maskEmail(e){if(!e)return"";const t=e.indexOf("@");if(t<2)return"*".repeat(e.length);const a=e.substring(0,2),n=e.substring(t);return a+"*".repeat(t-2)+n}function toggleEmailVisibility(){emailVisible=!emailVisible;const e=document.getElementById("displayEmail"),t=document.getElementById("emailToggle");emailVisible?(e.textContent=currentUser.email,t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye")):(e.textContent=maskEmail(currentUser.email),t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash"))}function validateTRC20(e){return/^T[A-Za-z1-9]{33}$/.test(e)}function switchTab(e){document.querySelectorAll(".tab-btn").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".section-content").forEach(e=>e.classList.remove("active")),event.target.classList.add("active"),document.getElementById(e+"Section").classList.add("active")}function toggleEditOptions(){document.getElementById("editModal").classList.add("show"),document.getElementById("modalOptions").style.display="flex",document.getElementById("modalInput").style.display="none",document.getElementById("fileUploadArea").style.display="none",document.getElementById("filePreview").style.display="none",document.getElementById("modalButtons").innerHTML='<button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>',document.getElementById("modalTitle").textContent="Edit Profile"}function selectEditType(e){editType=e,document.getElementById("modalOptions").style.display="none";const t=document.getElementById("modalInput"),a=document.getElementById("fileUploadArea"),n=document.getElementById("modalButtons");"username"===e?(document.getElementById("modalTitle").textContent="Change Username",t.style.display="block",t.placeholder="Enter new username",t.value="",a.style.display="none",n.innerHTML='<button class="modal-btn modal-btn-save" onclick="saveEdit()">Save</button><button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>'):"avatar"===e&&(document.getElementById("modalTitle").textContent="Change Avatar",t.style.display="block",t.placeholder="Or paste image URL here",t.value="",a.style.display="block",n.innerHTML='<button class="modal-btn modal-btn-save" onclick="saveEdit()">Save</button><button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>')}function handleFileSelect(e){const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return alert("Please select a valid image file!");const e=new FileReader;e.onload=function(e){selectedFile=e.target.result,document.getElementById("filePreview").src=selectedFile,document.getElementById("filePreview").style.display="block"},e.readAsDataURL(t)}}async function saveEdit(){if(!currentUser)return;if("username"===editType){const e=document.getElementById("modalInput").value;if(!e)return alert("Please enter username!");document.getElementById("displayName").textContent=e;const t=doc(db,"account_avatar",currentUser.uid),a=await getDoc(t);a.exists()?await updateDoc(t,{username:e,updatedAt:new Date}):await setDoc(t,{username:e,avatar:"X",avatarType:"letter",createdAt:new Date,updatedAt:new Date})}else if("avatar"===editType){const e=document.getElementById("modalInput").value,t=selectedFile;if(!t&&!e)return alert("Please upload image or paste URL!");const a=t||e;if(e&&!e.match(/^https?:\/\/.+/))return alert("Please enter valid URL!");document.getElementById("userAvatar").innerHTML=`<img src="${a}" style="width:100%;height:100%;object-fit:cover">`;const n=doc(db,"account_avatar",currentUser.uid),r=await getDoc(n);r.exists()?await updateDoc(n,{avatar:a,avatarType:"image",updatedAt:new Date}):await setDoc(n,{username:"New User",avatar:a,avatarType:"image",createdAt:new Date,updatedAt:new Date})}selectedFile=null,closeModal(),showSuccessToast()}function closeModal(){document.getElementById("editModal").classList.remove("show")}function showSuccessToast(){const e=document.getElementById("successToast");e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},2e3)}async function activateSecurity(){if(!currentUser)return;const e=doc(db,"account_status",currentUser.uid),t=await getDoc(e);let a=t.exists()?t.data():{};if(a.securityActivated)return;a.securityActivated=!0,t.exists()?await updateDoc(e,{securityActivated:!0,updatedAt:new Date}):await setDoc(e,{securityActivated:!0,loginSecurity:!1,withdrawSecurity:!1,createdAt:new Date,updatedAt:new Date}),document.getElementById("activateSecurityBtn").textContent="Security Activated",document.getElementById("activateSecurityBtn").classList.add("activated"),document.getElementById("activateSecurityBtn").disabled=!0,document.getElementById("securityOptions").classList.add("show"),showSuccessToast(),document.getElementById("successToast").textContent="✓ Security Activated Successfully!",setTimeout(()=>{document.getElementById("successToast").textContent="✓ Saved Successfully!"},2e3)}async function toggleSecurity(e){if(!currentUser)return;const t=doc(db,"account_status",currentUser.uid),a=await getDoc(t);if(!a.exists()||!a.data().securityActivated)return;const n=document.getElementById(e+"Toggle");let r={};if("login"===e){const a=!n.classList.contains("active");n.classList.toggle("active"),r={loginSecurity:a,updatedAt:new Date},await updateDoc(t,r)}else if("withdraw"===e){const a=!n.classList.contains("active");n.classList.toggle("active"),r={withdrawSecurity:a,updatedAt:new Date},await updateDoc(t,r)}}async function saveInfo(){if(!currentUser)return;const e=document.getElementById("firstName").value,t=document.getElementById("lastName").value,a=document.getElementById("birthDate").value,n=document.getElementById("address").value,r=document.getElementById("country").value,i=document.getElementById("idFront").value,s=document.getElementById("idBack").value;if(!e||!t||!a||!n||!r)return alert("Please fill all fields");if(!i||!s)return alert("Please enter ID image URLs");if(!i.match(/^https?:\/\/.+/)||!s.match(/^https?:\/\/.+/))return alert("Please enter valid image URLs");const o=doc(db,"account_status",currentUser.uid),d=await getDoc(o);d.exists()?await updateDoc(o,{firstName:e,lastName:t,birthDate:a,address:n,country:r,email:currentUser.email,idFront:i,idBack:s,verifying:!0,verified:!1,updatedAt:new Date}):await setDoc(o,{firstName:e,lastName:t,birthDate:a,address:n,country:r,email:currentUser.email,idFront:i,idBack:s,verifying:!0,verified:!1,securityActivated:!1,loginSecurity:!1,withdrawSecurity:!1,walletAddresses:[],createdAt:new Date,updatedAt:new Date}),document.getElementById("idUploadSection").style.display="none",updateVerificationStatus(),showSuccessToast()}async function updateVerificationStatus(){if(!currentUser)return;const e=doc(db,"account_status",currentUser.uid),t=await getDoc(e),a=document.getElementById("verificationStatus"),n=document.getElementById("verifyNoticeSection"),r=document.getElementById("warningBox");if(t.exists()){const e=t.data();e.verified?(a.innerHTML='<div class="verification-status success">✓ Your account is verified successfully</div>',n.innerHTML="",r.classList.add("hidden"),document.getElementById("verifyBadge").style.display="inline"):e.verifying?(a.innerHTML='<div class="verification-status">⏳ Your account is under verification. Please wait...</div>',n.innerHTML="",r.classList.add("hidden")):(a.innerHTML="",n.innerHTML='<div class="verify-notice" onclick="alert(\'Please complete your account information to verify your account and get the blue badge next to your name!\')">Verify your account to show blue badge next to your name</div>',r.classList.remove("hidden"))}else a.innerHTML="",n.innerHTML='<div class="verify-notice" onclick="alert(\'Please complete your account information to verify your account and get the blue badge next to your name!\')">Verify your account to show blue badge next to your name</div>',r.classList.remove("hidden")}async function renderWallets(){if(!currentUser)return;const e=doc(db,"account_status",currentUser.uid),t=await getDoc(e),a=document.getElementById("walletList");if(t.exists()&&t.data().walletAddresses&&t.data().walletAddresses.length>0){const e=t.data().walletAddresses;a.innerHTML=e.map((e,t)=>`<div class="wallet-item"><div class="wallet-item-info"><div class="wallet-item-address">${e}</div><div class="wallet-verified">✓ Verified</div></div><button class="wallet-item-delete" onclick="deleteWallet(${t})">Delete</button></div>`).join("")}else a.innerHTML='<div style="font-size:11px;color:rgba(255,255,255,.6);text-align:center;margin:8px 0">No TRC20 address added yet</div>'}async function addWallet(){if(!currentUser)return;const e=doc(db,"account_status",currentUser.uid),t=await getDoc(e);let a=t.exists()&&t.data().walletAddresses?t.data().walletAddresses:[];if(a.length>=3)return alert("Maximum 3 addresses");const n=prompt("Enter TRC20 wallet address:");if(n){if(!validateTRC20(n))return alert("Invalid TRC20 address! Must start with T and contain 34 characters");if(a.includes(n))return alert("Address already exists");a.push(n),t.exists()?await updateDoc(e,{walletAddresses:a,updatedAt:new Date}):await setDoc(e,{walletAddresses:a,email:currentUser.email,verified:!1,verifying:!1,securityActivated:!1,loginSecurity:!1,withdrawSecurity:!1,createdAt:new Date,updatedAt:new Date}),renderWallets(),showSuccessToast()}}async function deleteWallet(e){if(!currentUser)return;if(!confirm("Are you sure you want to delete this address?"))return;const t=doc(db,"account_status",currentUser.uid),a=await getDoc(t);if(a.exists()){let n=a.data().walletAddresses||[];n.splice(e,1),await updateDoc(t,{walletAddresses:n,updatedAt:new Date}),renderWallets()}}async function initRankBadge(){if(!currentUser)return;const e=doc(db,"Privileges",currentUser.uid),t=await getDoc(e);if(!t.exists()){const t={userId:currentUser.uid,rankBadgeUrl:"https://files.catbox.moe/lwz8oi.png",currentLevel:1,unlockedLevels:[1],totalSpent:0,createdAt:new Date,updatedAt:new Date};await setDoc(e,t),console.log("Created Privileges with default rankBadgeUrl")}updateRankBadge()}async function syncPrivilegesWithUsers(){if(!currentUser)return;const e=doc(db,"users",currentUser.uid),t=await getDoc(e);if(!t.exists())return;const a=t.data(),n=parseFloat(a.totaldeposit)||0,r=a.rank||"https://files.catbox.moe/lwz8oi.png",i=doc(db,"Privileges",currentUser.uid),s=await getDoc(i);let o=s.exists()?s.data():{userId:currentUser.uid,currentLevel:1,unlockedLevels:[1],totalSpent:0,rankBadgeUrl:"https://files.catbox.moe/lwz8oi.png",createdAt:new Date,updatedAt:new Date};o.totalSpent=n,o.rankBadgeUrl||(o.rankBadgeUrl=r);let d=1,c=[1];for(let e=PRIVILEGE_LEVELS.length-1;e>=0;e--)if(n>=PRIVILEGE_LEVELS[e].requiredAmount){d=PRIVILEGE_LEVELS[e].level;for(let e=1;e<=d;e++)c.push(e);c=[...new Set(c)];break}o.currentLevel=d,o.unlockedLevels=c,o.updatedAt=new Date,s.exists()?await updateDoc(i,o):await setDoc(i,o)}async function usePrivilegeIcon(e){if(!currentUser)return;const t=PRIVILEGE_LEVELS.find(t=>t.level===e);if(!t)return;const a=t.icon,n=doc(db,"account_avatar",currentUser.uid),r=await getDoc(n);r.exists()?await updateDoc(n,{avatar:a,avatarType:"image",updatedAt:new Date}):await setDoc(n,{username:"New User",avatar:a,avatarType:"image",createdAt:new Date,updatedAt:new Date}),document.getElementById("userAvatar").innerHTML=`<img src="${a}" style="width:100%;height:100%;object-fit:cover">`,showSuccessToast(),document.getElementById("successToast").textContent="✓ تم تطبيق الأيقونة!",setTimeout(()=>{document.getElementById("successToast").textContent="✓ Saved Successfully!"},2e3)}async function renderPrivileges(){if(!currentUser)return;await syncPrivilegesWithUsers();const e=doc(db,"Privileges",currentUser.uid),t=await getDoc(e);if(!t.exists())return;const a=t.data(),n=a.totalSpent||0,r=document.getElementById("privilegesList");r.innerHTML=PRIVILEGE_LEVELS.map(e=>{const t=a.unlockedLevels&&a.unlockedLevels.includes(e.level);let r=0,i="disabled",s=`<div class="progress-dot"></div>`,o="لم تستوفي الشروط";if(t)r=100,i="use-btn",o="استخدام",s=`<div class="progress-bar" style="width:100%"></div>`;else if(e.level>1){const t=PRIVILEGE_LEVELS[e.level-2].requiredAmount,a=e.requiredAmount,i=Math.max(0,Math.min(100,(n-t)/(a-t)*100));r=i,s=`<div class="progress-bar" style="width:${i}%"></div>`}else 1===e.level&&0===e.requiredAmount&&(r=0,s=`<div class="progress-bar" style="width:0%"></div>`);const d=t?`onclick="usePrivilegeIcon(${e.level})"`:""||"",c=t?"":"disabled";return`<div class="privilege-item"><div class="privilege-icon-container"><div class="privilege-frame"><img src="https://files.catbox.moe/nl89ql.png" alt="frame"></div><div class="privilege-icon"><img src="${e.icon}" alt="${e.title}"></div></div><div class="privilege-info"><div class="privilege-title">${e.title}</div><div class="privilege-desc">${e.desc}</div><div class="progress-container">${s}</div></div><button class="claim-btn ${i}" ${d} ${c}>${o}</button></div>`}).join("")}async function updateRankBadge(){if(!currentUser)return;const e=doc(db,"Privileges",currentUser.uid),t=await getDoc(e);if(t.exists()&&t.data().rankBadgeUrl){const e=t.data().rankBadgeUrl;document.getElementById("rankBadgeImg").src=e,console.log("Rank badge updated:",e)}else document.getElementById("rankBadgeImg").src="https://files.catbox.moe/lwz8oi.png"}async function loadUserData(){if(!currentUser)return;const e=doc(db,"account_avatar",currentUser.uid),t=await getDoc(e),a=doc(db,"account_status",currentUser.uid),n=await getDoc(a);if(document.getElementById("email").value=currentUser.email,document.getElementById("displayEmail").textContent=currentUser.email,t.exists()){const e=t.data();document.getElementById("displayName").textContent=e.username||"New User";const a=document.getElementById("userAvatar");e.avatar&&e.avatarType?"image"===e.avatarType?a.innerHTML=`<img src="${e.avatar}" style="width:100%;height:100%;object-fit:cover">`:a.innerHTML=e.avatar:a.innerHTML=(e.username||"M").charAt(0).toUpperCase()}else{await setDoc(e,{username:"New User",avatar:"X",avatarType:"letter",createdAt:new Date,updatedAt:new Date}),document.getElementById("displayName").textContent="New User";document.getElementById("userAvatar").innerHTML="M"}if(n.exists()){const e=n.data();e.verified&&(document.getElementById("verifyBadge").style.display="inline"),e.securityActivated&&(document.getElementById("activateSecurityBtn").textContent="Security Activated",document.getElementById("activateSecurityBtn").classList.add("activated"),document.getElementById("activateSecurityBtn").disabled=!0,document.getElementById("securityOptions").classList.add("show"),e.loginSecurity&&document.getElementById("loginToggle").classList.add("active"),e.withdrawSecurity&&document.getElementById("withdrawToggle").classList.add("active")),e.firstName&&(document.getElementById("firstName").value=e.firstName),e.lastName&&(document.getElementById("lastName").value=e.lastName),e.birthDate&&(document.getElementById("birthDate").value=e.birthDate),e.address&&(document.getElementById("address").value=e.address),e.country&&(document.getElementById("country").value=e.country),e.idFront&&e.idBack&&(document.getElementById("idFront").value=e.idFront,document.getElementById("idBack").value=e.idBack,document.getElementById("idUploadSection").style.display="none")}updateVerificationStatus(),renderWallets(),await initRankBadge(),await syncPrivilegesWithUsers(),renderPrivileges(),updateRankBadge()}onAuthStateChanged(auth,e=>{currentUser=e,e?loadUserData():window.location.href="/login.html"});window.toggleEmailVisibility=toggleEmailVisibility;window.toggleEditOptions=toggleEditOptions;window.selectEditType=selectEditType;window.handleFileSelect=handleFileSelect;window.saveEdit=saveEdit;window.closeModal=closeModal;window.switchTab=switchTab;window.activateSecurity=activateSecurity;window.toggleSecurity=toggleSecurity;window.saveInfo=saveInfo;window.addWallet=addWallet;window.deleteWallet=deleteWallet;window.usePrivilegeIcon=usePrivilegeIcon;document.getElementById("editModal").addEventListener("click",function(e){e.target===this&&closeModal()})</script></body></html>
    
  </body>
  
</html>
